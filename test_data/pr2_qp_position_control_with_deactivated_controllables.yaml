scope:
  # definition of some nice short-cuts
  - unit-x: {type: VECTOR3, inputs: [1, 0, 0]}
  - unit-y: {type: VECTOR3, inputs: [0, 1, 0]}
  - unit-z: {type: VECTOR3, inputs: [0, 0, 1]}
  
  
  # definition of joint input variables
  - torso_lift_joint: {type: INPUT, input-number: 0}
  - l_shoulder_pan_joint: {type: INPUT, input-number: 1}
  - l_shoulder_lift_joint: {type: INPUT, input-number: 2}
  - l_upper_arm_roll_joint: {type: INPUT, input-number: 3}
  - l_elbow_flex_joint: {type: INPUT, input-number: 4}
  - l_forearm_roll_joint: {type: INPUT, input-number: 5}
  - l_wrist_flex_joint: {type: INPUT, input-number: 6}
  - l_wrist_roll_joint: {type: INPUT, input-number: 7}
  
  
  # definition of joint transforms
  - torso_lift:
      type: FRAME
      translation: 
        type: VECTOR3
        inputs:
        - -0.05
        - 0
        - type: DOUBLE-ADDITION
          inputs: [0.739675, {double: torso_lift_joint}]
      rotation: # todo: replace by reference to unit-rotation to test that this also works
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-x}
        angle: 0
  - l_shoulder_pan:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0.0, 0.188, 0.0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-z}
        angle: {double: l_shoulder_pan_joint}
  - l_shoulder_lift:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0.1, 0, 0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-y}
        angle: {double: l_shoulder_lift_joint}
  - l_upper_arm_roll:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0, 0, 0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-x}
        angle: {double: l_upper_arm_roll_joint}
  - l_elbow_flex:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0.4, 0, 0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-y}
        angle: {double: l_elbow_flex_joint}
  - l_forearm_roll:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0, 0, 0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-x}
        angle: {double: l_forearm_roll_joint}
  - l_wrist_flex:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0.321, 0, 0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-y}
        angle: {double: l_wrist_flex_joint}
  - l_wrist_roll:
      type: FRAME
      translation: {type: VECTOR3, inputs: [0, 0, 0]}
      rotation:
        type: ROTATION
        axis: {type: VECTOR-REFERENCE, reference: unit-x}
        angle: {double: l_wrist_roll_joint}
  
  
  # defintion of entire FK, goal, and control law
  - pr2_fk:
      type: FRAME-MULTIPLICATION
      inputs:
      - {type: FRAME-REFERENCE, reference: torso_lift} 
      - {type: FRAME-REFERENCE, reference: l_shoulder_pan} 
      - {type: FRAME-REFERENCE, reference: l_shoulder_lift} 
      - {type: FRAME-REFERENCE, reference: l_upper_arm_roll} 
      - {type: FRAME-REFERENCE, reference: l_elbow_flex} 
      - {type: FRAME-REFERENCE, reference: l_forearm_roll} 
      - {type: FRAME-REFERENCE, reference: l_wrist_flex} 
      - {type: FRAME-REFERENCE, reference: l_wrist_roll} 
  - pr2_fk_pos:
      type: ORIGIN-OF
      frame: {type: FRAME-REFERENCE, reference: pr2_fk}
  - pr2_fk_goal: {type: VECTOR3, inputs: [0.6, 0.5, 0.7]}
  - pr2_fk_error_vector:
      type: VECTOR-SUBTRACTION
      inputs: [{type: VECTOR-REFERENCE, reference: pr2_fk_goal},
               {type: VECTOR-REFERENCE, reference: pr2_fk_pos}]
  - pr2_fk_error:
      type: NORM-OF
      vector: {type: VECTOR-REFERENCE, reference: pr2_fk_error_vector}
  - pr2_fk_control_law:
      type: DOUBLE-MULTIPLICATION
      inputs: [-10.0, {double: pr2_fk_error}]


controllable-constraints:
  - lower: 0.0
    upper: 0.0
    weight: 10.0
    input-number: 0
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 1
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 2
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 3
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 4
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 5
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 6
  - lower: -0.3
    upper: 0.3
    weight: 1.0
    input-number: 7


soft-constraints:
  - expression: {double: pr2_fk_error}
    lower: {double: pr2_fk_control_law}
    upper: {double: pr2_fk_control_law}
    weight: 10.0


hard-constraints:
  - expression: {double: torso_lift_joint}
    lower: {type: DOUBLE-SUBTRACTION, inputs: [0.0115, {double: torso_lift_joint}]}
    upper: {type: DOUBLE-SUBTRACTION, inputs: [0.325, {double: torso_lift_joint}]}
  - expression: {double: l_shoulder_pan_joint}
    lower: {type: DOUBLE-SUBTRACTION, inputs: [-0.5646, {double: l_shoulder_pan_joint}]}
    upper: {type: DOUBLE-SUBTRACTION, inputs: [2.1353, {double: l_shoulder_pan_joint}]}
  - expression: {double: l_shoulder_lift_joint}
    lower: {type: DOUBLE-SUBTRACTION, inputs: [-0.3536, {double: l_shoulder_lift_joint}]}
    upper: {type: DOUBLE-SUBTRACTION, inputs: [1.2963, {double: l_shoulder_lift_joint}]}
  - expression: {double: l_upper_arm_roll_joint}
    lower: {type: DOUBLE-SUBTRACTION, inputs: [-0.65, {double: l_upper_arm_roll_joint}]}
    upper: {type: DOUBLE-SUBTRACTION, inputs: [3.75, {double: l_upper_arm_roll_joint}]}
  - expression: {double: l_elbow_flex_joint}
    lower: {type: DOUBLE-SUBTRACTION, inputs: [-2.1213, {double: l_elbow_flex_joint}]}
    upper: {type: DOUBLE-SUBTRACTION, inputs: [-0.15, {double: l_elbow_flex_joint}]}
  - expression: {double: l_wrist_flex_joint}
    lower: {type: DOUBLE-SUBTRACTION, inputs: [-2.0, {double: l_wrist_flex_joint}]}
    upper: {type: DOUBLE-SUBTRACTION, inputs: [-0.1, {double: l_wrist_flex_joint}]}

